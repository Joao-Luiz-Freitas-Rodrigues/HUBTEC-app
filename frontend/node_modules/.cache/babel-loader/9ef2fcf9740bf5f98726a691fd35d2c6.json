{"ast":null,"code":"import { takeLatest, put, call, select } from 'redux-saga/effects';\nimport axios from 'axios';\nimport { getUserId } from './selectors';\nconst base_url = 'http://localhost:3001'; /////////// CONJUNTO DE FUNÇÕES RELACIONADOS AO USUÁRIO /////////\n\nfunction getUser(user) {\n  return axios({\n    method: 'POST',\n    url: \"\".concat(base_url, \"/authenticate\"),\n    data: {\n      email: user.email,\n      password: user.password\n    }\n  });\n}\n\nfunction* asyncLogIn(action) {\n  try {\n    const response = yield call(getUser, action.payload);\n    yield put({\n      type: 'LOG_IN',\n      payload: response.data\n    }); //PRÉ CARREGA A LISTA DE TASKS DO USUÁRIO\n\n    const task = yield call(getTasks, response.data._id);\n    console.log(task.data);\n    yield put({\n      type: 'TASK_LIST',\n      payload: task.data\n    });\n  } catch (e) {\n    const message = e.response.data.error;\n    yield put({\n      type: 'ERRO_LOGIN',\n      payload: message\n    }); //LIMPA A MENSAGEM DO TOAST\n\n    yield put({\n      type: 'CLEAR_MESSAGE'\n    });\n  }\n} ///CRIAÇÃO DE NOVO USUÁRIO\n\n\nfunction newUser(data) {\n  return axios({\n    method: 'POST',\n    url: \"\".concat(base_url, \"/users\"),\n    data: {\n      nome: data.nome,\n      email: data.email,\n      password: data.senha\n    }\n  });\n}\n\nfunction* asyncNewUser(action) {\n  try {\n    const response = yield call(newUser, action.payload);\n    yield put({\n      type: 'LOG_IN',\n      payload: response.data\n    }); //PRÉ CARREGA A LISTA DE TASKS DO USUÁRIO\n\n    const task = yield call(getTasks, response.data._id);\n    console.log(task.data);\n    yield put({\n      type: 'TASK_LIST',\n      payload: task.data\n    });\n  } catch (e) {\n    console.log(e.data);\n  }\n} //////////////// AÇÕES RELACIONADAS AS TASKS ///////////////\n//CONSULTA TODAS AS TASKS DE UM USUÁRIO ESPECÍFICO\n\n\nfunction getTasks(id) {\n  return axios({\n    method: 'GET',\n    url: \"\".concat(base_url, \"/tasks\"),\n    headers: {\n      user_id: id\n    }\n  });\n} //TASK ADD \n\n\nfunction addTask(task, user_id) {\n  return axios({\n    method: 'POST',\n    url: \"\".concat(base_url, \"/task\"),\n    headers: {\n      user_id\n    },\n    data: {\n      descricao: task.descricao,\n      data_entrega: task.data_entrega\n    }\n  });\n}\n\nfunction* asyncAddTask(action) {\n  try {\n    const user_id = yield select(getUserId);\n    const response = yield call(addTask, action.payload, user_id);\n    console.log(response);\n    yield put({\n      type: 'ADD_SUCESS',\n      payload: \"Task criada com sucesso!\"\n    });\n    const task = yield call(getTasks, user_id);\n    yield put({\n      type: 'TASK_LIST',\n      payload: task.data\n    });\n  } catch (e) {\n    console.log(e.response);\n  }\n} //TASK EDIT\n\n\nfunction editTask(task) {\n  return axios({\n    method: 'PUT',\n    url: \"\".concat(base_url, \"/update/\").concat(task.id),\n    data: {\n      descricao: task.descricao,\n      data_entrega: task.data_entrega\n    }\n  });\n}\n\nfunction* asyncTaskEdit(action) {\n  console.log(action);\n\n  try {\n    const response = yield call(editTask, action.payload);\n    console.log(response);\n    yield put({\n      type: 'EDIT_SUCESS',\n      payload: \"Task editada com sucesso!\"\n    });\n    const user_id = yield select(getUserId);\n    const task = yield call(getTasks, user_id);\n    yield put({\n      type: 'TASK_LIST',\n      payload: task.data\n    });\n  } catch (e) {\n    console.log(e.response);\n  }\n} //TASK DELETE\n\n\nfunction deleteTask(id) {\n  return axios({\n    method: 'PUT',\n    url: \"\".concat(base_url, \"/delete/\").concat(id)\n  });\n}\n\nfunction* asyncDeleteTask(action) {\n  try {\n    yield call(deleteTask, action.payload);\n    yield put({\n      type: 'DELETE_SUCESS'\n    });\n    const user_id = yield select(getUserId);\n    const task = yield call(getTasks, user_id);\n    yield put({\n      type: 'TASK_LIST',\n      payload: task.data\n    });\n  } catch (e) {\n    console.log(e.data);\n  }\n}\n\nexport default function* root() {\n  yield takeLatest('ASYNC_LOG_IN', asyncLogIn);\n  yield takeLatest('ASYNC_NEW_USER', asyncNewUser);\n  yield takeLatest('ASYNC_EDIT_TASK', asyncTaskEdit);\n  yield takeLatest('ASYNC_DELETE_TASK', asyncDeleteTask);\n  yield takeLatest('ASYNC_ADD_TASK', asyncAddTask);\n}","map":{"version":3,"sources":["/Users/mac/Documents/workspace/react/frontend/src/store/sagas.js"],"names":["takeLatest","put","call","select","axios","getUserId","base_url","getUser","user","method","url","data","email","password","asyncLogIn","action","response","payload","type","task","getTasks","_id","console","log","e","message","error","newUser","nome","senha","asyncNewUser","id","headers","user_id","addTask","descricao","data_entrega","asyncAddTask","editTask","asyncTaskEdit","deleteTask","asyncDeleteTask","root"],"mappings":"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","sourcesContent":["import { takeLatest, put, call, select } from 'redux-saga/effects'; \nimport axios from 'axios';\n\nimport { getUserId } from './selectors';\n\nconst base_url = 'http://localhost:3001'\n\n\n\n/////////// CONJUNTO DE FUNÇÕES RELACIONADOS AO USUÁRIO /////////\n\nfunction getUser(user){\n    \n    return axios({\n        method: 'POST',\n        url:`${base_url}/authenticate`,\n        data:{\n            email:user.email,\n            password: user.password\n        }\n    })\n}\n\nfunction* asyncLogIn(action){\n\n    try{\n        const response = yield call(getUser, action.payload);        \n\n        yield put({ type: 'LOG_IN', payload: response.data});\n\n        \n        //PRÉ CARREGA A LISTA DE TASKS DO USUÁRIO\n        const task = yield call(getTasks, response.data._id);\n        console.log(task.data);\n        \n        yield put({type: 'TASK_LIST', payload: task.data});\n        \n    } catch(e){\n        const message = e.response.data.error;\n        yield put({type:'ERRO_LOGIN', payload: message});\n        //LIMPA A MENSAGEM DO TOAST\n        yield put({type:'CLEAR_MESSAGE'});\n    }\n    \n    \n}\n\n///CRIAÇÃO DE NOVO USUÁRIO\nfunction newUser(data){\n    return axios({\n        method:'POST',\n        url:`${base_url}/users`,\n        data:{\n            nome: data.nome,\n            email: data.email,\n            password: data.senha\n\n        }\n    })\n}\n\nfunction* asyncNewUser(action){\n\n    try{\n        const response = yield call(newUser, action.payload);\n        yield put({ type: 'LOG_IN', payload: response.data});\n\n        \n        //PRÉ CARREGA A LISTA DE TASKS DO USUÁRIO\n        const task = yield call(getTasks, response.data._id);\n        console.log(task.data);\n        \n        yield put({type: 'TASK_LIST', payload: task.data});\n\n    }catch(e){\n        console.log(e.data);\n        \n    }\n}\n\n//////////////// AÇÕES RELACIONADAS AS TASKS ///////////////\n\n//CONSULTA TODAS AS TASKS DE UM USUÁRIO ESPECÍFICO\nfunction getTasks(id){\n    return axios({\n        method:'GET',\n        url:`${base_url}/tasks`,\n        headers:{\n            user_id:id\n        }\n    })\n}\n\n//TASK ADD \n\nfunction addTask(task, user_id){\n    return axios({\n        method:'POST',\n        url:`${base_url}/task`,\n        headers:{\n            user_id\n        },\n        data:{\n            descricao:task.descricao,\n            data_entrega:task.data_entrega\n        }\n    })\n}\n\nfunction* asyncAddTask(action){\n\n    try{\n        const user_id = yield select(getUserId);\n\n        const response = yield call(addTask, action.payload, user_id);\n        console.log(response);\n        \n        yield put({ type:'ADD_SUCESS', payload:\"Task criada com sucesso!\"});\n\n        \n        const task = yield call(getTasks, user_id );\n        \n        yield put({type: 'TASK_LIST', payload: task.data});\n    }catch(e){\n        console.log(e.response);\n        \n    }\n}\n\n//TASK EDIT\nfunction editTask(task){\n    return axios({\n        method:'PUT',\n        url:`${base_url}/update/${task.id}`,\n        data:{\n            descricao:task.descricao,\n            data_entrega: task.data_entrega\n        }\n    })\n}\n\nfunction* asyncTaskEdit(action){\n    console.log(action);\n    \n    try{\n        const response = yield call(editTask, action.payload);\n        console.log(response);\n        \n        yield put({ type:'EDIT_SUCESS', payload:\"Task editada com sucesso!\"});\n        \n        const user_id = yield select(getUserId);\n        \n        const task = yield call(getTasks, user_id );\n        \n        yield put({type: 'TASK_LIST', payload: task.data});\n        \n    }catch(e){\n        console.log(e.response);\n        \n    }\n}\n\n//TASK DELETE\nfunction deleteTask(id){\n    return axios({\n        method:'PUT',\n        url:`${base_url}/delete/${id}`\n    })\n}\nfunction* asyncDeleteTask(action){\n    \n    try{\n        \n        yield call(deleteTask, action.payload);\n        \n        yield put({ type:'DELETE_SUCESS'})\n\n        const user_id = yield select(getUserId);\n        \n        const task = yield call(getTasks, user_id );\n        yield put({type: 'TASK_LIST', payload: task.data});\n\n    }catch(e){\n        console.log(e.data);\n        \n    }\n}\n\nexport default function* root(){ \n    \n    yield takeLatest('ASYNC_LOG_IN', asyncLogIn)\n    yield takeLatest('ASYNC_NEW_USER', asyncNewUser)\n\n    yield takeLatest('ASYNC_EDIT_TASK', asyncTaskEdit)\n    yield takeLatest('ASYNC_DELETE_TASK', asyncDeleteTask)\n    yield takeLatest('ASYNC_ADD_TASK', asyncAddTask)\n    \n}\n"]},"metadata":{},"sourceType":"module"}